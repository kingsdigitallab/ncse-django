{% extends 'periodicals/base.html' %}
{% load humanize periodicals_tags %}

{% block title %}
{{ issue }}
{% endblock %}

{% block meta_title %}
{{ issue }}
{% endblock %}

{% block main %}

{% with ads=issue.ads departments=issue.departments articles=issue.articles pictures=issue.pictures %}
<div class="row" id="main">
    <div class="small-12 medium-3 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="main">
            <div class="menu vertical">
                <ul class="multilevel-accordion-menu vertical menu">
                    <li>
                        <a href="#a1">Departments <span>({{departments.count}})</span></a>
                    </li>
                    <li>
                        <a href="#a2">Adverts <span>({{ ads.count }})</i></span></a>
                    </li>
                    <li>
                        <a href="#">Pictures <span>({{pictures.count}})</i></span></a>
                    </li>
                    <li>
                        <a href="#">Text <span>({{ articles.count}})</i></span></a>
                    </li>
                    <li>
                        <a href="#a3">Pages <span>({{ issue.number_of_pages }})</span></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    

    <div class="medium-9 columns">    
        <div class="row">   
        {% include "periodicals/includes/issue_toc.html" with items=ads %}
        </div>
  
        <hr>

         <div class="row">   
        {% include "periodicals/includes/issue_toc.html" with items=pictures %}
        </div>
  
        <hr>

         <div class="row">   
        {% include "periodicals/includes/issue_toc.html" with items=articles %}
        </div>
  
        <hr>

        <div class="row">
            <h2>Departments</h2>
            {% regroup departments by page as page_list %}
            {% for page in page_list %}
                {% for department in page.list %}
                   
                    <div class="medium-2 columns">
                        {% if forloop.first %}
                        Page {{ page.grouper.number }}
                        {% endif %}
                    </div>
                    <div class="medium-10 columns">
                        <!-- Will remove span style border -->
                        <img style="border:1px solid #ccc" src="{% thumbnail department.title_image.url %}" alt="{{ department }}">
                    </div>

                {% endfor %}
            {% endfor %}
        </div>


        <hr>

        <div class="row">
      
        {% include "periodicals/includes/page_gallery.html" with pages=issue.pages.all %}
        </div>

    </div>
</div>

{% endwith %}

{% endblock %}